---
title: "week_2"
format: html
---

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(readr)
library(skimr)
```

```{r}
#| message: false
#| warning: false
theme_set(
  theme_minimal(base_size = 18) +
    theme(
      plot.title = element_text(face = "bold", size = 20, hjust = 0.5),
      axis.title = element_text(size = 18, face = "bold",hjust = 0.5),
      axis.text  = element_text(size = 15),
      legend.text = element_text(size = 14),
      legend.title = element_text(size = 15, face = "bold")
    )
)
```

## Задачи

-   Загрузка датасета Ammon-1996 (у нас команда 1). 
  -   Сергей делает Occasion 1, Милана делает Occasion 2

-   (EDA) Визуализация кривых концентрация-время (спагетти-плот) В виде индивидуальных кривых (сравнение между occasion) В виде среднего +- стандартное отклонение для каждой временной точки

-   (EDA) Расчет основных ФК + визуализация распределений

-   Использование ANOVA для определения межсубъектной (Inter-individual) и внутрисубъектной (intra-individual/between subject/inter-occasion) вариабельности

-   Расчет CVinter и CVintra для каждого из ФК параметров, а также оценка вклада (в % от общей вариабельности) inter и intra компонент

-   Визуализация результатов (визуализация отклонений от среднего для каждого субъекта или любой другой вариант, который вам покажется информативным)

-   Интерпретация результатов и короткий отчет (в виде power point презентации или R markdown)

```{r}
Ammon_1996 <- read_csv("data/raw/Ammon-1996.csv")
Ammon_1996 %>% 
  group_by(occasion) %>%
  select(-study_id, -route, -subject_id, - food, -site) %>%
  skim()
```
## 1 Occasion 1 (Сергей)
### Выделение датасета с occasion 1
```{r Occasion 1}
occasion_1 <- Ammon_1996  %>% 
  filter(occasion == 1) 
occasion_1
```

### Визуализации спагетти-плот
```{r}
occasion_1 %>% 
ggplot(aes(x = time_min,
             y = conc_g_per_L,
             group = subject_id,
             color = factor(subject_id))) +
  geom_line(alpha = 0.6) +
  geom_point(size = 0.8, alpha = 0.8) +
  labs(x = "Время, мин",
       y = "Концентрация, г/л",
       color = "Испытуемый",
       title = "График концентраций по испытуемым в виде индивидуальных кривых") +
  theme_bw() +
  theme(legend.position = "none")
           
```

### Расчет ФК + визуализация распределений

```{r}

```

### ANOVA

```{r}

```

### CVInter, CVintra + визуализация результатов

```{r}

```


## 2 Occasion 2 (Милана)
### Выделение датасета с occasion 1

```{r Occasion 2}

```


### Визуализации спагетти-плот
```{r}

```

### Расчет ФК + визуализация распределений

```{r}

```

### ANOVA

```{r}

```

### CVInter, CVintra + визуализация результатов
```{r}

```

